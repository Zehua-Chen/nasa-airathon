---

title: Deep Learning Model


keywords: fastai
sidebar: home_sidebar



nb_path: "model.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: model.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;2.7.0&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-Data">Loading Data<a class="anchor-link" href="#Loading-Data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">tfrecord</span><span class="o">.</span><span class="n">load_tfrecord</span><span class="p">(</span>
    <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">dataset</span><span class="p">(),</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;maiac&quot;</span><span class="p">,</span> <span class="s2">&quot;maiac-2000.tfrecord&quot;</span><span class="p">))</span>

<span class="n">ds</span><span class="o">.</span><span class="n">element_spec</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;datetime&#39;: TensorSpec(shape=(), dtype=tf.string, name=None),
 &#39;grid_id&#39;: TensorSpec(shape=(), dtype=tf.string, name=None),
 &#39;location&#39;: TensorSpec(shape=(), dtype=tf.string, name=None),
 &#39;sds_0&#39;: TensorSpec(shape=(240, 240, 4), dtype=tf.float32, name=None),
 &#39;sds_3&#39;: TensorSpec(shape=(240, 240, 4), dtype=tf.float32, name=None),
 &#39;sds_4&#39;: TensorSpec(shape=(240, 240, 4), dtype=tf.float32, name=None),
 &#39;sds_8&#39;: TensorSpec(shape=(240, 240, 4), dtype=tf.float32, name=None),
 &#39;value&#39;: TensorSpec(shape=(), dtype=tf.float32, name=None)}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preprocessing">Preprocessing<a class="anchor-link" href="#Preprocessing"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_y" class="doc_header"><code>get_y</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/model/__init__.py#L27" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_y</code>(<strong><code>dataset</code></strong>:<code>DatasetV2</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_y</span> <span class="o">=</span> <span class="n">get_y</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds_y</span><span class="o">.</span><span class="n">element_spec</span><span class="p">)</span>

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ds_y</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>TensorSpec(shape=(1,), dtype=tf.float32, name=None)
tf.Tensor([10.125], shape=(1,), dtype=float32)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="location_to_one_hot" class="doc_header"><code>location_to_one_hot</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/model/__init__.py#L31" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>location_to_one_hot</code>(<strong><code>location</code></strong>:<code>Tensor</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">location_to_one_hot</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="s2">&quot;tpe&quot;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(3,), dtype=float32, numpy=array([1., 0., 0.], dtype=float32)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_x" class="doc_header"><code>get_x</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/model/__init__.py#L54" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_x</code>(<strong><code>x</code></strong>:<code>DatasetV2</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_x</span> <span class="o">=</span> <span class="n">get_x</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ds_x</span><span class="o">.</span><span class="n">element_spec</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ds_x</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>TensorSpec(shape=(921603,), dtype=tf.float32, name=None)
(921603,)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds_x_y</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">zip</span><span class="p">((</span><span class="n">ds_x</span><span class="p">,</span> <span class="n">ds_y</span><span class="p">))</span>
<span class="n">ds_x_y</span> <span class="o">=</span> <span class="n">ds_x_y</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">ds_x_y</span><span class="o">.</span><span class="n">element_spec</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorSpec(shape=(921603,), dtype=tf.float32, name=None),
 TensorSpec(shape=(1,), dtype=tf.float32, name=None))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_size</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mi">2000</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">))</span>
<span class="n">val_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">total_size</span> <span class="o">-</span> <span class="n">train_size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;total_size = </span><span class="si">{</span><span class="n">total_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;train_size = </span><span class="si">{</span><span class="n">train_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;val_size = </span><span class="si">{</span><span class="n">val_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ds_train</span> <span class="o">=</span> <span class="n">ds_x_y</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="n">train_size</span><span class="p">)</span>
<span class="n">ds_val</span> <span class="o">=</span> <span class="n">ds_x_y</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="n">train_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>total_size = 2000
train_size = 1600
val_size = 400
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Defining-Model">Defining Model<a class="anchor-link" href="#Defining-Model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ImageModel" class="doc_header"><code>class</code> <code>ImageModel</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/model/__init__.py#L58" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ImageModel</code>() :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Args:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>Note: Only dicts, lists, and tuples of input tensors are supported. Nested
inputs are not supported (e.g. lists of list or dicts of dict).</p>
<p>A new Functional API model can also be created by using the
intermediate tensors. This enables you to quickly extract sub-components
of the model.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">processed</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">32</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">processed</span><span class="p">)</span>
<span class="n">pooling</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GlobalAveragePooling2D</span><span class="p">()(</span><span class="n">conv</span><span class="p">)</span>
<span class="n">feature</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)(</span><span class="n">pooling</span><span class="p">)</span>

<span class="n">full_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
<span class="n">backbone</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">processed</span><span class="p">,</span> <span class="n">conv</span><span class="p">)</span>
<span class="n">activations</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">conv</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
</pre></div>
<p>Note that the <code>backbone</code> and <code>activations</code> models are not
created with <code>keras.Input</code> objects, but with the tensors that are originated
from <code>keras.Inputs</code> objects. Under the hood, the layers and weights will
be shared across these models, so that user can train the <code>full_model</code>, and
use <code>backbone</code> or <code>activations</code> to do feature extraction.
The inputs and outputs of the model can be nested structures of tensors as
well, and the created models are standard Functional API models that support
all the existing APIs.</p>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__()</code> and you should implement the model's forward pass
in <code>call()</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call()</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MyModel" class="doc_header"><code>class</code> <code>MyModel</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/model/__init__.py#L94" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MyModel</code>() :: <code>Model</code></p>
</blockquote>
<p><code>Model</code> groups layers into an object with training and inference features.</p>
<p>Args:
    inputs: The input(s) of the model: a <code>keras.Input</code> object or list of
        <code>keras.Input</code> objects.
    outputs: The output(s) of the model. See Functional API example below.
    name: String, the name of the model.</p>
<p>There are two ways to instantiate a <code>Model</code>:</p>
<p>1 - With the "Functional API", where you start from <code>Input</code>,
you chain layer calls to specify the model's forward pass,
and finally you create your model from inputs and outputs:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
<p>Note: Only dicts, lists, and tuples of input tensors are supported. Nested
inputs are not supported (e.g. lists of list or dicts of dict).</p>
<p>A new Functional API model can also be created by using the
intermediate tensors. This enables you to quickly extract sub-components
of the model.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">processed</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">32</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">conv</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">processed</span><span class="p">)</span>
<span class="n">pooling</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GlobalAveragePooling2D</span><span class="p">()(</span><span class="n">conv</span><span class="p">)</span>
<span class="n">feature</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">)(</span><span class="n">pooling</span><span class="p">)</span>

<span class="n">full_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
<span class="n">backbone</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">processed</span><span class="p">,</span> <span class="n">conv</span><span class="p">)</span>
<span class="n">activations</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">conv</span><span class="p">,</span> <span class="n">feature</span><span class="p">)</span>
</pre></div>
<p>Note that the <code>backbone</code> and <code>activations</code> models are not
created with <code>keras.Input</code> objects, but with the tensors that are originated
from <code>keras.Inputs</code> objects. Under the hood, the layers and weights will
be shared across these models, so that user can train the <code>full_model</code>, and
use <code>backbone</code> or <code>activations</code> to do feature extraction.
The inputs and outputs of the model can be nested structures of tensors as
well, and the created models are standard Functional API models that support
all the existing APIs.</p>
<p>2 - By subclassing the <code>Model</code> class: in that case, you should define your
layers in <code>__init__()</code> and you should implement the model's forward pass
in <code>call()</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>If you subclass <code>Model</code>, you can optionally have
a <code>training</code> argument (boolean) in <code>call()</code>, which you can use to specify
a different behavior in training and inference:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense1</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">training</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">training</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
</pre></div>
<p>Once the model is created, you can config the model with losses and metrics
with <code>model.compile()</code>, train the model with <code>model.fit()</code>, or use the model
to do prediction with <code>model.predict()</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_compiled_model" class="doc_header"><code>create_compiled_model</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/model/__init__.py#L152" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_compiled_model</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training">Training<a class="anchor-link" href="#Training"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">create_compiled_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">ds_train</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> 
    <span class="n">epochs</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> 
    <span class="c1"># validation_data=ds_val.batch(100)</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Loss&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;R2&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;R2&quot;</span><span class="p">)</span>
<span class="c1"># plt.plot(history.history[&quot;val_R2&quot;], label=&quot;Val R2&quot;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/40
16/16 [==============================] - 15s 647ms/step - loss: 6232.3823 - R2: 0.0584 - root_mean_squared_error: 78.9454
Epoch 2/40
16/16 [==============================] - 14s 642ms/step - loss: 6256.1802 - R2: -0.0545 - root_mean_squared_error: 79.0960
Epoch 3/40
16/16 [==============================] - 14s 643ms/step - loss: 6409.5767 - R2: -0.0420 - root_mean_squared_error: 80.0598
Epoch 4/40
16/16 [==============================] - 14s 642ms/step - loss: 6008.9150 - R2: 0.1416 - root_mean_squared_error: 77.5172
Epoch 5/40
16/16 [==============================] - 15s 643ms/step - loss: 5986.1489 - R2: 0.0928 - root_mean_squared_error: 77.3702
Epoch 6/40
16/16 [==============================] - 14s 642ms/step - loss: 5928.6768 - R2: 0.2083 - root_mean_squared_error: 76.9979
Epoch 7/40
16/16 [==============================] - 14s 643ms/step - loss: 6033.9102 - R2: 0.0106 - root_mean_squared_error: 77.6782
Epoch 8/40
16/16 [==============================] - 14s 644ms/step - loss: 6061.6675 - R2: 0.0764 - root_mean_squared_error: 77.8567
Epoch 9/40
16/16 [==============================] - 15s 648ms/step - loss: 5684.3042 - R2: -0.0673 - root_mean_squared_error: 75.3943
Epoch 10/40
16/16 [==============================] - 15s 642ms/step - loss: 5100.4644 - R2: 0.2494 - root_mean_squared_error: 71.4175
Epoch 11/40
16/16 [==============================] - 15s 643ms/step - loss: 4992.5645 - R2: -0.2512 - root_mean_squared_error: 70.6581
Epoch 12/40
16/16 [==============================] - 14s 643ms/step - loss: 5264.0000 - R2: 0.2325 - root_mean_squared_error: 72.5534
Epoch 13/40
16/16 [==============================] - 15s 646ms/step - loss: 4935.7202 - R2: 0.1648 - root_mean_squared_error: 70.2547
Epoch 14/40
16/16 [==============================] - 14s 645ms/step - loss: 4730.5830 - R2: 0.1676 - root_mean_squared_error: 68.7792
Epoch 15/40
16/16 [==============================] - 14s 644ms/step - loss: 4951.2856 - R2: 0.3359 - root_mean_squared_error: 70.3654
Epoch 16/40
16/16 [==============================] - 15s 645ms/step - loss: 4866.5952 - R2: -0.0323 - root_mean_squared_error: 69.7610
Epoch 17/40
16/16 [==============================] - 14s 646ms/step - loss: 4509.0215 - R2: 0.4489 - root_mean_squared_error: 67.1492
Epoch 18/40
16/16 [==============================] - 14s 641ms/step - loss: 4613.1304 - R2: 0.2900 - root_mean_squared_error: 67.9200
Epoch 19/40
16/16 [==============================] - 14s 643ms/step - loss: 4628.9946 - R2: 0.3655 - root_mean_squared_error: 68.0367
Epoch 20/40
16/16 [==============================] - 15s 642ms/step - loss: 4782.8525 - R2: 0.1923 - root_mean_squared_error: 69.1582
Epoch 21/40
16/16 [==============================] - 14s 650ms/step - loss: 4660.1333 - R2: 0.2496 - root_mean_squared_error: 68.2652
Epoch 22/40
16/16 [==============================] - 14s 641ms/step - loss: 4444.5708 - R2: 0.1621 - root_mean_squared_error: 66.6676
Epoch 23/40
16/16 [==============================] - 14s 640ms/step - loss: 4144.9023 - R2: 0.2423 - root_mean_squared_error: 64.3809
Epoch 24/40
16/16 [==============================] - 14s 641ms/step - loss: 4129.2207 - R2: 0.3527 - root_mean_squared_error: 64.2590
Epoch 25/40
16/16 [==============================] - 14s 644ms/step - loss: 4408.7617 - R2: 0.5018 - root_mean_squared_error: 66.3985
Epoch 26/40
16/16 [==============================] - 14s 641ms/step - loss: 4033.6431 - R2: 0.0729 - root_mean_squared_error: 63.5110
Epoch 27/40
16/16 [==============================] - 14s 641ms/step - loss: 3862.3794 - R2: 0.3444 - root_mean_squared_error: 62.1480
Epoch 28/40
16/16 [==============================] - 15s 642ms/step - loss: 4349.8945 - R2: -0.0583 - root_mean_squared_error: 65.9537
Epoch 29/40
16/16 [==============================] - 14s 643ms/step - loss: 4014.6260 - R2: 0.1628 - root_mean_squared_error: 63.3611
Epoch 30/40
16/16 [==============================] - 14s 641ms/step - loss: 3841.0090 - R2: 0.4885 - root_mean_squared_error: 61.9759
Epoch 31/40
16/16 [==============================] - 14s 642ms/step - loss: 4064.4639 - R2: 0.3561 - root_mean_squared_error: 63.7531
Epoch 32/40
16/16 [==============================] - 14s 643ms/step - loss: 3861.3813 - R2: 0.3997 - root_mean_squared_error: 62.1400
Epoch 33/40
16/16 [==============================] - 14s 642ms/step - loss: 3243.6125 - R2: 0.4059 - root_mean_squared_error: 56.9527
Epoch 34/40
16/16 [==============================] - 15s 642ms/step - loss: 3674.5615 - R2: 0.0472 - root_mean_squared_error: 60.6182
Epoch 35/40
16/16 [==============================] - 14s 640ms/step - loss: 3576.6394 - R2: 0.3580 - root_mean_squared_error: 59.8050
Epoch 36/40
16/16 [==============================] - 14s 642ms/step - loss: 3820.7532 - R2: 0.3663 - root_mean_squared_error: 61.8122
Epoch 37/40
16/16 [==============================] - 15s 640ms/step - loss: 3614.3835 - R2: 0.4792 - root_mean_squared_error: 60.1197
Epoch 38/40
16/16 [==============================] - 15s 642ms/step - loss: 3618.4263 - R2: -0.0408 - root_mean_squared_error: 60.1534
Epoch 39/40
16/16 [==============================] - 14s 641ms/step - loss: 3486.5645 - R2: 0.5579 - root_mean_squared_error: 59.0471
Epoch 40/40
16/16 [==============================] - 14s 640ms/step - loss: 3417.2153 - R2: 0.5541 - root_mean_squared_error: 58.4570
Model: &#34;my_model&#34;
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_1 (InputLayer)        [(None, 921603)]          0         
                                                                 
 image_model (ImageModel)    multiple                  2912      
                                                                 
 image_model_1 (ImageModel)  multiple                  2912      
                                                                 
 image_model_2 (ImageModel)  multiple                  2912      
                                                                 
 dense (Dense)               multiple                  10334464  
                                                                 
 dropout_6 (Dropout)         multiple                  0         
                                                                 
 dense_1 (Dense)             multiple                  2080      
                                                                 
 dropout_7 (Dropout)         multiple                  0         
                                                                 
 dense_2 (Dense)             multiple                  528       
                                                                 
 dense_3 (Dense)             multiple                  17        
                                                                 
=================================================================
Total params: 10,345,825
Trainable params: 10,345,825
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Saving-Model">Saving Model<a class="anchor-link" href="#Saving-Model"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;saves&quot;</span><span class="p">,</span> <span class="s2">&quot;zc2616_v1&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_ds</span> <span class="o">=</span> <span class="n">tfrecord</span><span class="o">.</span><span class="n">load_tfrecord</span><span class="p">(</span>
    <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">dataset</span><span class="p">(),</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;maiac&quot;</span><span class="p">,</span> <span class="s2">&quot;maiac.tfrecord&quot;</span><span class="p">))</span>

<span class="n">test_ds</span> <span class="o">=</span> <span class="n">test_ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">test_x</span> <span class="o">=</span> <span class="n">get_x</span><span class="p">(</span><span class="n">test_ds</span><span class="p">)</span>
<span class="n">test_x</span><span class="o">.</span><span class="n">element_spec</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TensorSpec(shape=(921603,), dtype=tf.float32, name=None)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_datetime</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="n">test_grid_id</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">test_ds</span><span class="p">:</span>
    
    <span class="n">datetime</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>
    <span class="n">grid_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;grid_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">grid_id</span><span class="p">)</span>

    <span class="n">test_datetime</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datetime</span><span class="p">)</span>
    <span class="n">test_grid_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grid_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
X5DKW
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
X5DKW
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
H96P6
PG3MI
X5DKW
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
X5DKW
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
X5DKW
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
X5DKW
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
QJHW4
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
QJHW4
X5DKW
ZP1FZ
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
QJHW4
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
DJN0F
E5P9N
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
1X116
9Q6TA
KW43U
VR4WG
XJF9O
3S31A
A2FBI
E5P9N
FRITQ
H96P6
PG3MI
QJHW4
WT52R
X5DKW
ZP1FZ
ZZ8JF
1X116
9Q6TA
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict_result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_x</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_value</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span> 

<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">predict_result</span><span class="p">:</span> 
    <span class="n">test_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;datetime&quot;</span><span class="p">:</span> <span class="n">test_datetime</span><span class="p">,</span> <span class="s2">&quot;grid_id&quot;</span><span class="p">:</span> <span class="n">test_grid_id</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">test_value</span><span class="p">})</span>

<span class="n">test_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/home/zc2616/competition/model.ipynb Cell 30&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Bcoms4995deep/home/zc2616/competition/model.ipynb#ch0000029vscode-remote?line=0&#39;&gt;1&lt;/a&gt;</span> test_df = pd.DataFrame({
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Bcoms4995deep/home/zc2616/competition/model.ipynb#ch0000029vscode-remote?line=1&#39;&gt;2&lt;/a&gt;</span>     &#34;datetime&#34;: test_datetime, &#34;grid_id&#34;: test_grid_id, &#34;value&#34;: test_value})
<span class="ansi-green-intense-fg ansi-bold">      &lt;a href=&#39;vscode-notebook-cell://ssh-remote%2Bcoms4995deep/home/zc2616/competition/model.ipynb#ch0000029vscode-remote?line=3&#39;&gt;4&lt;/a&gt;</span> test_df

<span class="ansi-red-fg">NameError</span>: name &#39;pd&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;result.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

