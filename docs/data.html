---

title: Load Labels


keywords: fastai
sidebar: home_sidebar



nb_path: "data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_labels" class="doc_header"><code>load_labels</code><a href="https://github.com/Zehua-Chen/coms4995-deep-competitionairathon/data/__init__.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_labels</code>(<strong><code>labels</code></strong>:<code>str</code>, <strong><code>sample</code></strong>:<code>Optional</code>[<code>int</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Load the "labels" csv file as <code>pd.DataFrame</code> and <code>tf.data.Dataset</code></p>
<p>Note that the y dataset the function returns is in 1d arrays, which cannot
be used for keras training</p>
<p>X is returned as a data frame as it is string based; pd.DataFrame
is more friendly to further string processing</p>
<p>Args:
    labels (str): path to the labels file
    sample (Optional[int]): if not none, the number of rows to sample from
    the complete data frame</p>
<p>Returns:
    Tuple[pd.DataFrame, Dataset]: x, y; x dataframe is containing
    "datetime" and "grid_id" columns, and y is a 1d array of values</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">airathon.paths</span> <span class="k">as</span> <span class="nn">paths</span> 
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">path</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_labels</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">dataset_metadata</span><span class="p">(),</span> <span class="s2">&quot;train_labels.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">full_x</span><span class="p">,</span> <span class="n">full_y</span> <span class="o">=</span> <span class="n">load_labels</span><span class="p">(</span>
    <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">dataset_metadata</span><span class="p">(),</span> <span class="s2">&quot;train_labels.csv&quot;</span><span class="p">))</span>
<span class="n">full_x</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>grid_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-02-01T08:00:00Z</td>
      <td>3S31A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018-02-01T08:00:00Z</td>
      <td>A2FBI</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-02-01T08:00:00Z</td>
      <td>DJN0F</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2018-02-01T08:00:00Z</td>
      <td>E5P9N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2018-02-01T08:00:00Z</td>
      <td>FRITQ</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>34307</th>
      <td>2020-12-31T18:30:00Z</td>
      <td>P8JA5</td>
    </tr>
    <tr>
      <th>34308</th>
      <td>2020-12-31T18:30:00Z</td>
      <td>PW0JT</td>
    </tr>
    <tr>
      <th>34309</th>
      <td>2020-12-31T18:30:00Z</td>
      <td>VXNN3</td>
    </tr>
    <tr>
      <th>34310</th>
      <td>2020-12-31T18:30:00Z</td>
      <td>VYH7U</td>
    </tr>
    <tr>
      <th>34311</th>
      <td>2020-12-31T18:30:00Z</td>
      <td>ZF3ZW</td>
    </tr>
  </tbody>
</table>
<p>34312 rows × 2 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">part_x</span><span class="p">,</span> <span class="n">part_y</span> <span class="o">=</span> <span class="n">load_labels</span><span class="p">(</span>
    <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">dataset_metadata</span><span class="p">(),</span> <span class="s2">&quot;train_labels.csv&quot;</span><span class="p">),</span>
    <span class="n">sample</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
<span class="n">part_x</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>grid_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-28T16:00:00Z</td>
      <td>VR4WG</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-03T18:30:00Z</td>
      <td>SZLMT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018-04-05T18:30:00Z</td>
      <td>GVQXS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-08-13T18:30:00Z</td>
      <td>GVQXS</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-10-19T08:00:00Z</td>
      <td>VBLD0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>295</th>
      <td>2019-07-01T08:00:00Z</td>
      <td>3S31A</td>
    </tr>
    <tr>
      <th>296</th>
      <td>2018-08-22T18:30:00Z</td>
      <td>WZNCR</td>
    </tr>
    <tr>
      <th>297</th>
      <td>2019-09-20T18:30:00Z</td>
      <td>AZJ0Z</td>
    </tr>
    <tr>
      <th>298</th>
      <td>2018-04-28T18:30:00Z</td>
      <td>SZLMT</td>
    </tr>
    <tr>
      <th>299</th>
      <td>2020-06-19T18:30:00Z</td>
      <td>VYH7U</td>
    </tr>
  </tbody>
</table>
<p>300 rows × 2 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

